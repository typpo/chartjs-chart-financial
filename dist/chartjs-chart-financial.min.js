/*!
 * @license
 * chartjs-chart-financial
 * http://chartjs.org/
 * Version: 0.1.0
 *
 * Copyright 2022 Chart.js Contributors
 * Released under the MIT license
 * https://github.com/chartjs/chartjs-chart-financial/blob/master/LICENSE.md
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("chart.js-v3")):"function"==typeof define&&define.amd?define(["chart.js-v3"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ChartJs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=t(e);const{BarController:o,defaults:a}=l.default,{clipArea:n,isNullOrUndef:r,unclipArea:i}=l.default.helpers;class s extends o{getLabelAndValue(e){const t=this,l=t.getParsed(e),o=t._cachedMeta.iScale.axis,{o:a,h:n,l:r,c:i}=l,s=`O: ${a}  H: ${n}  L: ${r}  C: ${i}`;return{label:`${t._cachedMeta.iScale.getLabelForValue(l[o])}`,value:s}}getAllParsedValues(){const e=this._cachedMeta,t=e.iScale.axis,l=e._parsed,o=[];for(let e=0;e<l.length;++e)o.push(l[e][t]);return o}getMinMax(e){const t=this._cachedMeta,l=t._parsed,o=t.iScale.axis;if(l.length<2)return{min:0,max:1};if(e===t.iScale)return{min:l[0][o],max:l[l.length-1][o]};let a=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(let e=0;e<l.length;e++){const t=l[e];a=Math.min(a,t.l),n=Math.max(n,t.h)}return{min:a,max:n}}_getRuler(){const e=this,t=e.options,l=e._cachedMeta,o=l.iScale,a=o.axis,n=[];for(let t=0;t<l.data.length;++t)n.push(o.getPixelForValue(e.getParsed(t)[a]));const r=t.barThickness,i=function(e,t){let l,o,a,n,r=e._length;for(a=1,n=t.length;a<n;++a)r=Math.min(r,Math.abs(t[a]-t[a-1]));for(a=0,n=e.ticks.length;a<n;++a)o=e.getPixelForTick(a),r=a>0?Math.min(r,Math.abs(o-l)):r,l=o;return r}(o,n);return{min:i,pixels:n,start:o._startPixel,end:o._endPixel,stackCount:e._getStackCount(),scale:o,ratio:r?1:t.categoryPercentage*t.barPercentage}}calculateElementProperties(e,t,l,o){const a=this,n=a._cachedMeta.vScale,r=n.getBasePixel(),i=a._calculateBarIndexPixels(e,t,o),s=a.chart.data.datasets[a.index].data[e],c=n.getPixelForValue(s.o),d=n.getPixelForValue(s.h),h=n.getPixelForValue(s.l),u=n.getPixelForValue(s.c);return{base:l?r:h,x:i.center,y:(h+d)/2,width:i.size,open:c,high:d,low:h,close:u}}draw(){const e=this,t=e.chart,l=e._cachedMeta.data;n(t.ctx,t.chartArea);for(let t=0;t<l.length;++t)l[t].draw(e._ctx);i(t.ctx)}}s.overrides={label:"",parsing:!1,hover:{mode:"label"},datasets:{categoryPercentage:.8,barPercentage:.9,animation:{numbers:{type:"number",properties:["x","y","base","width","open","high","low","close"]}}},scales:{x:{type:"timeseries",offset:!0,ticks:{major:{enabled:!0},fontStyle:e=>e.tick.major?"bold":void 0,source:"data",maxRotation:0,autoSkip:!0,autoSkipPadding:75,sampleSize:100},afterBuildTicks:e=>{const t=window&&window.luxon&&window.luxon.DateTime;if(!t)return;const l=e._majorUnit,o=e.ticks,a=o[0];if(!a)return;let n=t.fromMillis(a.value);"minute"===l&&0===n.second||"hour"===l&&0===n.minute||"day"===l&&9===n.hour||"month"===l&&n.day<=3&&1===n.weekday||"year"===l&&1===n.month?a.major=!0:a.major=!1;let r=n.get(l);for(let e=1;e<o.length;e++){const a=o[e];n=t.fromMillis(a.value);const i=n.get(l);a.major=i!==r,r=i}e.ticks=o}},y:{type:"linear"}},plugins:{tooltip:{intersect:!1,mode:"index",callbacks:{label(e){const t=e.parsed;if(!r(t.y))return a.plugins.tooltip.callbacks.label(e);const{o:l,h:o,l:n,c:i}=t;return`O: ${l}  H: ${o}  L: ${n}  C: ${i}`}}}}};function c(e,t,l,o){const a=null===t,n=null===l,r=!(!e||a&&n)&&function(e,t){const{x:l,y:o,base:a,width:n,height:r}=e.getProps(["x","low","high","width","height"],t);let i,s,c,d,h;return e.horizontal?(h=r/2,i=Math.min(l,a),s=Math.max(l,a),c=o-h,d=o+h):(h=n/2,i=l-h,s=l+h,c=Math.min(o,a),d=Math.max(o,a)),{left:i,top:c,right:s,bottom:d}}(e,o);return r&&(a||t>=r.left&&t<=r.right)&&(n||l>=r.top&&l<=r.bottom)}e.Chart.defaults.elements.financial={color:{up:"rgba(80, 160, 115, 1)",down:"rgba(215, 85, 65, 1)",unchanged:"rgba(90, 90, 90, 1)"}};class d extends e.Element{height(){return this.base-this.y}inRange(e,t,l){return c(this,e,t,l)}inXRange(e,t){return c(this,e,null,t)}inYRange(e,t){return c(this,null,e,t)}getRange(e){return"x"===e?this.width/2:this.height/2}getCenterPoint(e){const{x:t,low:l,high:o}=this.getProps(["x","low","high"],e);return{x:t,y:(o+l)/2}}tooltipPosition(e){const{x:t,open:l,close:o}=this.getProps(["x","open","close"],e);return{x:t,y:(l+o)/2}}}const h=l.default.Chart,{merge:u,valueOrDefault:g}=l.default.helpers,m=h.defaults;class f extends d{draw(e){const t=this,{x:l,open:o,high:a,low:n,close:r}=t;let i,s=t.borderColor;"string"==typeof s&&(s={up:s,down:s,unchanged:s}),r<o?(i=g(s?s.up:void 0,m.elements.candlestick.borderColor),e.fillStyle=g(t.color?t.color.up:void 0,m.elements.candlestick.color.up)):r>o?(i=g(s?s.down:void 0,m.elements.candlestick.borderColor),e.fillStyle=g(t.color?t.color.down:void 0,m.elements.candlestick.color.down)):(i=g(s?s.unchanged:void 0,m.elements.candlestick.borderColor),e.fillStyle=g(t.color?t.color.unchanged:void 0,m.elements.candlestick.color.unchanged)),e.lineWidth=g(t.borderWidth,m.elements.candlestick.borderWidth),e.strokeStyle=g(i,m.elements.candlestick.borderColor),e.beginPath(),e.moveTo(l,a),e.lineTo(l,Math.min(o,r)),e.moveTo(l,n),e.lineTo(l,Math.max(o,r)),e.stroke(),e.fillRect(l-t.width/2,r,t.width,o-r),e.strokeRect(l-t.width/2,r,t.width,o-r),e.closePath()}}f.id="candlestick",f.defaults=u({},[m.elements.financial,{borderColor:m.elements.financial.color.unchanged,borderWidth:1}]);const p=l.default.Chart,{merge:b}=l.default.helpers;class x extends s{updateElements(e,t,l,o){const a=this,n=a.getDataset(),r=a._ruler||a._getRuler(),i=a.resolveDataElementOptions(t,o),s=a.getSharedOptions(i),c=a.includeOptions(o,s);a.updateSharedOptions(s,o,i);for(let i=t;i<l;i++){const t=s||a.resolveDataElementOptions(i,o),l={...a.calculateElementProperties(i,r,"reset"===o,t),datasetLabel:n.label||"",color:n.color,borderColor:n.borderColor,borderWidth:n.borderWidth};c&&(l.options=t),a.updateElement(e[i],i,l,o)}}}x.id="candlestick",x.defaults=b({dataElementType:f.id},p.defaults.financial);const w=l.default.Chart,{merge:y,valueOrDefault:P}=l.default.helpers,k=w.defaults;class v extends d{draw(e){const t=this,{x:l,open:o,high:a,low:n,close:r}=t,i=P(t.armLengthRatio,k.elements.ohlc.armLengthRatio);let s=P(t.armLength,k.elements.ohlc.armLength);null===s&&(s=t.width*i*.5),e.strokeStyle=r<o?P(t.color?t.color.up:void 0,k.elements.ohlc.color.up):r>o?P(t.color?t.color.down:void 0,k.elements.ohlc.color.down):P(t.color?t.color.unchanged:void 0,k.elements.ohlc.color.unchanged),e.lineWidth=P(t.lineWidth,k.elements.ohlc.lineWidth),e.beginPath(),e.moveTo(l,a),e.lineTo(l,n),e.moveTo(l-s,o),e.lineTo(l,o),e.moveTo(l+s,r),e.lineTo(l,r),e.stroke()}}v.id="ohlc",v.defaults=y({},[k.elements.financial,{lineWidth:2,armLength:null,armLengthRatio:.8}]);const M=l.default.Chart,{merge:_}=l.default.helpers;class T extends s{updateElements(e,t,l,o){const a=this,n=a.getDataset(),r=a._ruler||a._getRuler(),i=a.resolveDataElementOptions(t,o),s=a.getSharedOptions(i),c=a.includeOptions(o,s);for(let t=0;t<l;t++){const l=s||a.resolveDataElementOptions(t,o),i={...a.calculateElementProperties(t,r,"reset"===o,l),datasetLabel:n.label||"",lineWidth:n.lineWidth,armLength:n.armLength,armLengthRatio:n.armLengthRatio,color:n.color};c&&(i.options=l),a.updateElement(e[t],t,i,o)}}}T.id="ohlc",T.defaults=_({dataElementType:v.id,datasets:{barPercentage:1,categoryPercentage:1}},M.defaults.financial),e.Chart.register(x,T,f,v)}));
